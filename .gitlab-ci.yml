stages:
    - quality_tests
    - unit_tests
    - performances_tests
    - aws_deployment
    - server_configuration
    - deployment

quality_tests:
    stage: quality_tests
    image: php:fpm
    before_script:
        - curl -o insight.phar -s http://get.insight.sensiolabs.com/insight.phar
    script:
        - php insight.phar analyze --no-interaction --no-ansi $INSIGHT_PROJECT_ID --reference=$CI_COMMIT_SHA --user-uuid="$INSIGHT_USER_UID" --api-token="$INSIGHT_USER_TOKEN"
    only:
        - master

unit:
    stage: unit_tests
    script:
        - echo 'Hello World'

performances:
    stage: performances_tests
    script:
        - echo 'Hello World'

aws:
    stage: aws_deployment
    image: python
    before_script:
        - pip install awscli
    script:
        - aws s3 cp ./ s3://$AWS_S3_BUCKET_NAME/ --recursive
    only:
        - master

server:
    stage: server_configuration
    script:
        - echo 'Hello World'

deployment:
    stage: deployment
    script:
        - echo 'Hello World'
